name: Covidson


on: push

#    schedule:

#        - cron: '0 11 * * *'


jobs:

    build:

        runs-on: ubuntu-latest


        steps:

            - name: Keep this repo alive
              uses: gautamkrishnar/keepalive-workflow@master

            - name: Setup python and run
              uses: actions/setup-python@v4
              with:
                    python-version: '3.7'
                    cache: 'pip'
            - run: pip install -r requirements.txt
            - run: python covidson.py
            
            - name: Check the repo for changes
              uses: actions/checkout@v2
              with:
                fetch-depth: 0
                ref: main

            - name: Commit and push
              run: |-
                git config user.name "Rilufi"
                git config user.email "actions@users.noreply.github.com"
                git add -A
                timestamp=$(date -u)
                git commit -m "Latest data: ${timestamp}" || exit 0
                git push
